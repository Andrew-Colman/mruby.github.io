#!/bin/bash

set -euo pipefail
IFS=$'\n\t'

if [ -d "mruby" ]; then
	pushd mruby
	# Fetch updated sources
	git pull
	popd
else
	# Clone a fresh mruby repo
	git clone https://github.com/mruby/mruby.git
fi

# Clean old docs
rm -rf docs/c-api
mkdir docs/c-api
cp gen/c-api.template/doxy-boot.js docs/c-api/

# Generate docs
doxygen gen/c-api.doxyfile
